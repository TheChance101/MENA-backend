databaseChangeLog:
  - changeSet:
      id: 1-trends
      author: alqassim
      comment: Create the trends schema
      changes:
        - sql: CREATE SCHEMA IF NOT EXISTS trends;

  - changeSet:
      id: 2-trends
      author: alqassim
      comment: Create the trends tables
      changes:
          - sql:
              CREATE TABLE trends.categories (
                id UUID PRIMARY KEY NOT NULL DEFAULT gen_random_uuid(),
                name VARCHAR NOT NULL UNIQUE,
                emoji VARCHAR NOT NULL
              );
          - sql:
              CREATE TABLE trends.reels (
                id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
                owner_id UUID NOT NULL,
                thumbnail_url VARCHAR NOT NULL,
                video_url VARCHAR NOT NULL,
                description VARCHAR NOT NULL,
                likes_count INTEGER NOT NULL DEFAULT 0,
                views_count INTEGER NOT NULL DEFAULT 0,
                created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
              );
          - sql:
              CREATE TABLE trends.reel_categories (
                reel_id UUID NOT NULL,
                category_id UUID NOT NULL,
                PRIMARY KEY (reel_id, category_id),
                FOREIGN KEY (reel_id) REFERENCES trends.reels(id) ON DELETE CASCADE,
                FOREIGN KEY (category_id) REFERENCES trends.categories(id) ON DELETE CASCADE
              );