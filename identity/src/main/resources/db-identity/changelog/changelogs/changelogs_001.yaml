databaseChangeLog:
  - changeSet:
      id: 1-identity
      author: alqassim
      comment: Create the identity schema
      changes:
        - sql: CREATE SCHEMA IF NOT EXISTS identity;

  - changeSet:
      id: 2-identity
      author: alqassim
      comment: Create the users and refresh_tokens tables in the identity schema
      changes:
        - sql:
            CREATE TABLE identity.users (
            id UUID PRIMARY KEY,
            phone_number VARCHAR(255) NOT NULL,
            password VARCHAR(255) NOT NULL
            );

        - sql:
            CREATE TABLE identity.refresh_tokens (
            id BIGSERIAL PRIMARY KEY,
            refresh_token VARCHAR(255) NOT NULL,
            expires_in BIGINT NOT NULL,
            user_id UUID NOT NULL,
            CONSTRAINT fk_refresh_tokens_user_id FOREIGN KEY (user_id) REFERENCES identity.users(id)
            );

  - changeSet:
      id: 3-identity
      author: alqassim
      comment: Create the login_log table in the identity schema
      changes:
        - sql:
            CREATE TABLE identity.login_log (
              id UUID NOT NULL,
              user_id UUID NOT NULL,
              is_success BOOLEAN NOT NULL,
              login_time TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
              ip_address TEXT NOT NULL,
              PRIMARY KEY (id),
              CONSTRAINT fk_user_id FOREIGN KEY (user_id) REFERENCES identity.users(id)
            );
